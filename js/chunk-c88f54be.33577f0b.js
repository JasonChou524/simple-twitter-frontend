(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c88f54be"],{1511:function(t,a,e){"use strict";e.r(a);var r=function(){var t=this,a=t._self._c;return a("div",{staticClass:"user-container"},[a("div",{staticClass:"row"},[a("nav-tabs",{staticClass:"col-3",on:{afterCreateTweet:t.afterCreateTweet}}),t.isLoading?a("spinner",{staticClass:"col-6"}):a("section",{staticClass:"col-6"},[a("div",{staticClass:"user"},[a("nav",{staticClass:"header"},[a("a",{on:{click:function(a){return t.$router.go(-1)}}},[a("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M20 10.9999H7.41399L11.707 6.70687C12.097 6.31687 12.097 5.68388 11.707 5.29288C11.317 4.90188 10.684 4.90288 10.293 5.29288L4.29299 11.2929C3.90299 11.6829 3.90299 12.3159 4.29299 12.7069L10.293 18.7069C10.488 18.9019 10.743 18.9999 11 18.9999C11.257 18.9999 11.512 18.9019 11.707 18.7069C12.097 18.3169 12.097 17.6839 11.707 17.2929L7.41399 12.9999H20C20.553 12.9999 21 12.5529 21 11.9999C21 11.4469 20.553 10.9999 20 10.9999Z"}})])]),a("div",{staticClass:"title"},[a("h6",[t._v(t._s(t.user.name))]),a("p",[t._v(t._s(t.user.tweetsCount)+" 推文")])])]),a("div",{staticClass:"img-wrap"},[t.user.frontCover?a("img",{staticClass:"front-cover",attrs:{src:t.user.frontCover,alt:""}}):a("img",{staticClass:"front-cover",attrs:{src:e("314e"),alt:""}}),a("div",{staticClass:"avatar"},[t.user.avatar?a("img",{attrs:{src:t.user.avatar,alt:""}}):a("img",{attrs:{src:e("f7f5"),alt:""}})])]),a("div",{staticClass:"user-card"},[t.pageUserId===t.currentUser.id?a("div",{staticClass:"card-header"},[a("button",{on:{click:t.openEditModal}},[t._v("編輯個人資料")])]):a("div",{staticClass:"card-header"},[t.user.isFollowed?a("button",{staticClass:"unfollow-btn",on:{click:function(a){return t.removeFollow(t.user.id)}}},[t._v(" 正在跟隨 ")]):a("button",{staticClass:"follow-btn",on:{click:function(a){return t.addFollow(t.user.id)}}},[t._v(" 跟隨 ")])]),a("div",{staticClass:"card-body"},[a("h6",[t._v(t._s(t.user.name))]),a("p",{staticClass:"account"},[t._v("@"+t._s(t.user.account))]),a("p",[t._v(" "+t._s(t.user.introduction)+" ")]),a("div",{staticClass:"follow-info"},[a("router-link",{attrs:{to:{name:"user-following",params:{id:t.$route.params.id}}}},[t._v(t._s(t.user.followingsCount)+" 個"),a("span",[t._v("跟隨中")])]),a("router-link",{attrs:{to:{name:"user-follower",params:{id:t.$route.params.id}}}},[t._v(t._s(t.user.Followers.length)+" 位"),a("span",[t._v("跟隨者")])])],1)])]),a("nav",{staticClass:"navtabs"},[a("ul",[a("li",{attrs:{"active-class":"active"}},[a("router-link",{staticClass:"nav-link",attrs:{to:{name:"user-tweets",params:{id:t.$route.params.id}},replace:""}},[t._v("推文")])],1),a("li",{attrs:{"active-class":"active"}},[a("router-link",{staticClass:"nav-link",attrs:{to:{name:"user-replies",params:{id:t.$route.params.id}},replace:""}},[t._v("回覆")])],1),a("li",{attrs:{"active-class":"active"}},[a("router-link",{staticClass:"nav-link",attrs:{to:{name:"user-likes",params:{id:t.$route.params.id}},replace:""}},[t._v("喜歡的內容")])],1)])]),a("router-view",{attrs:{user:t.user,newTweet:t.newTweet,reply:t.reply}})],1)]),a("user-popular",{staticClass:"col-3"})],1),t.isEditModalOpen?a("user-edit-modal",{attrs:{user:t.user},on:{clickCloseBtn:t.closeEditModal,handleSubmit:t.afterSubmit}}):t._e(),t.isReplyModalOpen?a("tweet-reply-modal",{on:{afterCreateReply:t.afterCreateReply}}):t._e()],1)},s=[],i=(e("14d9"),e("d9e2"),e("8bb1")),o=e("f55a"),n=function(){var t=this,a=t._self._c;return a("div",{staticClass:"modal-background"},[a("form",{staticClass:"modal-card",on:{submit:function(a){return a.stopPropagation(),a.preventDefault(),t.handleSubmit(a)}}},[a("div",{staticClass:"card-header"},[a("button",{staticClass:"close-btn",attrs:{type:"button"},on:{click:t.clickCloseBtn}},[a("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M13.4141 11.9999L19.2071 6.20687C19.5971 5.81687 19.5971 5.18388 19.2071 4.79288C18.8171 4.40188 18.1841 4.40288 17.7931 4.79288L12.0001 10.5859L6.20712 4.79288C5.81712 4.40288 5.18412 4.40288 4.79312 4.79288C4.40212 5.18288 4.40312 5.81587 4.79312 6.20687L10.5861 11.9999L4.79312 17.7929C4.40312 18.1829 4.40312 18.8159 4.79312 19.2069C4.98812 19.4019 5.24312 19.4999 5.50012 19.4999C5.75712 19.4999 6.01212 19.4019 6.20712 19.2069L12.0001 13.4139L17.7931 19.2069C17.9881 19.4019 18.2431 19.4999 18.5001 19.4999C18.7571 19.4999 19.0121 19.4019 19.2071 19.2069C19.5971 18.8169 19.5971 18.1839 19.2071 17.7929L13.4141 11.9999Z"}})])]),a("h4",[t._v("編輯個人資料")]),a("button",{staticClass:"submit-btn",attrs:{type:"submit"}},[t._v("儲存")])]),a("div",{staticClass:"card-image"},[a("div",{staticClass:"avatar"},[t.formData.avatar?a("img",{attrs:{src:t.formData.avatar,alt:""}}):a("img",{attrs:{src:e("f7f5"),alt:""}}),a("label",{staticClass:"svg-btn",attrs:{for:"avatar"}},[a("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M19.708 22H4.292C3.028 22 2 20.972 2 19.708V7.375C2 6.11 3.028 5.083 4.292 5.083H6.438C7.633 3.17 9.722 2 12 2C14.277 2 16.367 3.17 17.562 5.083H19.708C20.972 5.083 22 6.11 22 7.375V19.708C22 20.972 20.972 22 19.708 22ZM4.292 6.583C3.855 6.583 3.5 6.938 3.5 7.375V19.708C3.5 20.145 3.855 20.5 4.292 20.5H19.708C20.145 20.5 20.5 20.145 20.5 19.708V7.375C20.5 6.938 20.145 6.583 19.708 6.583H17.258C16.941 6.633 16.626 6.488 16.476 6.201C15.596 4.536 13.882 3.501 12 3.501C10.117 3.501 8.402 4.536 7.524 6.203C7.364 6.505 7.022 6.663 6.691 6.583H4.293H4.292Z"}}),a("path",{attrs:{d:"M11.9999 8.16699C9.31989 8.16699 7.13989 10.347 7.13989 13.027C7.13989 15.707 9.31989 17.887 11.9999 17.887C14.6799 17.887 16.8599 15.707 16.8599 13.027C16.8599 10.347 14.6799 8.16699 11.9999 8.16699ZM13.9999 13.75H12.7499V15C12.7499 15.414 12.4139 15.75 11.9999 15.75C11.5859 15.75 11.2499 15.414 11.2499 15V13.75H9.99989C9.58589 13.75 9.24989 13.414 9.24989 13C9.24989 12.586 9.58589 12.25 9.99989 12.25H11.2499V11C11.2499 10.586 11.5859 10.25 11.9999 10.25C12.4139 10.25 12.7499 10.586 12.7499 11V12.25H13.9999C14.4139 12.25 14.7499 12.586 14.7499 13C14.7499 13.414 14.4139 13.75 13.9999 13.75Z"}})]),a("input",{staticStyle:{display:"none"},attrs:{id:"avatar",name:"avatar",type:"file"},on:{change:function(a){return t.uploadImage("avatar",a)}}})])]),t.formData.frontCover?a("img",{staticClass:"front-cover",attrs:{src:t.formData.frontCover,alt:""}}):a("img",{staticClass:"front-cover",attrs:{src:e("314e"),alt:""}}),a("div",{staticClass:"front-cover-btn"},[a("label",{staticClass:"svg-btn",attrs:{for:"front-cover"}},[a("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M19.708 22H4.292C3.028 22 2 20.972 2 19.708V7.375C2 6.11 3.028 5.083 4.292 5.083H6.438C7.633 3.17 9.722 2 12 2C14.277 2 16.367 3.17 17.562 5.083H19.708C20.972 5.083 22 6.11 22 7.375V19.708C22 20.972 20.972 22 19.708 22ZM4.292 6.583C3.855 6.583 3.5 6.938 3.5 7.375V19.708C3.5 20.145 3.855 20.5 4.292 20.5H19.708C20.145 20.5 20.5 20.145 20.5 19.708V7.375C20.5 6.938 20.145 6.583 19.708 6.583H17.258C16.941 6.633 16.626 6.488 16.476 6.201C15.596 4.536 13.882 3.501 12 3.501C10.117 3.501 8.402 4.536 7.524 6.203C7.364 6.505 7.022 6.663 6.691 6.583H4.293H4.292Z"}}),a("path",{attrs:{d:"M11.9999 8.16699C9.31989 8.16699 7.13989 10.347 7.13989 13.027C7.13989 15.707 9.31989 17.887 11.9999 17.887C14.6799 17.887 16.8599 15.707 16.8599 13.027C16.8599 10.347 14.6799 8.16699 11.9999 8.16699ZM13.9999 13.75H12.7499V15C12.7499 15.414 12.4139 15.75 11.9999 15.75C11.5859 15.75 11.2499 15.414 11.2499 15V13.75H9.99989C9.58589 13.75 9.24989 13.414 9.24989 13C9.24989 12.586 9.58589 12.25 9.99989 12.25H11.2499V11C11.2499 10.586 11.5859 10.25 11.9999 10.25C12.4139 10.25 12.7499 10.586 12.7499 11V12.25H13.9999C14.4139 12.25 14.7499 12.586 14.7499 13C14.7499 13.414 14.4139 13.75 13.9999 13.75Z"}})]),a("input",{staticStyle:{display:"none"},attrs:{id:"front-cover",name:"front_cover",type:"file"},on:{change:function(a){return t.uploadImage("frontCover",a)}}})])])]),a("ul",{staticClass:"card-input"},[a("li",{staticClass:"input-area name"},[a("label",{attrs:{for:"name"}},[t._v("名稱")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.name,expression:"formData.name"}],attrs:{type:"text",id:"name",name:"name",placeholder:"請輸入使用者名稱",required:""},domProps:{value:t.formData.name},on:{input:function(a){a.target.composing||t.$set(t.formData,"name",a.target.value)}}}),a("p",[t._v(t._s(t.nameLength)+"/50")])]),a("li",{staticClass:"input-area introduction"},[a("label",{attrs:{for:"introduction"}},[t._v("自我介紹")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.introduction,expression:"formData.introduction"}],staticClass:"introduction",attrs:{id:"introduction",name:"introduction",placeholder:"請輸入自我介紹"},domProps:{value:t.formData.introduction},on:{input:function(a){a.target.composing||t.$set(t.formData,"introduction",a.target.value)}}}),t._v(" "),a("p",[t._v(t._s(t.introductionLength)+"/160")])])])])])},l=[],c=e("4cce"),d=e("2fa3"),u={props:["user"],data(){return{formData:{}}},computed:{nameLength(){return this.formData.name?this.formData.name.length:0},introductionLength(){return this.formData.introduction?this.formData.introduction.length:0}},created(){this.formData={...this.user}},methods:{clickCloseBtn(){this.$emit("clickCloseBtn")},async handleSubmit(t){try{if(0===this.formData.name.trim().length)return void d["a"].fire({icon:"error",title:"名稱不能空白"});if(!this.formData.introduction||0===this.formData.introduction.trim().length)return void d["a"].fire({icon:"error",title:"自我介紹不能空白"});if(this.formData.name===this.user.name&&this.formData.introduction===this.user.introduction&&this.formData.avatar===this.user.avatar&&this.formData.frontCover===this.user.frontCover)return void d["a"].fire({icon:"error",title:"沒有修改任何資料"});const a=t.target,e=new FormData(a),r=this.$route.params.id,{data:s}=await c["a"].userEdit({id:r,editData:e});if("error"===s.status)throw new Error(s);this.$store.commit("setCurrentUser",s.newData),this.$emit("handleSubmit"),this.$emit("clickCloseBtn")}catch(a){if(a.response){const{data:t}=a.response;d["a"].fire({icon:"error",title:""+t.message})}else d["a"].fire({icon:"error",title:"無法修改資料"})}},uploadImage(t,a){const e=a.target.files[0];if(e){const a=window.URL.createObjectURL(e);this.formData[t]=a}}}},C=u,m=(e("6134"),e("2877")),f=Object(m["a"])(C,n,l,!1,null,"56c6fe8c",null),p=f.exports,v=e("811a"),h=e("2375"),w=e("2f62"),g={components:{NavTabs:i["a"],UserPopular:o["a"],TweetReplyModal:v["a"],UserEditModal:p,Spinner:h["a"]},data(){return{user:{id:-1,name:"",tweetsCount:0,account:"",introduction:"",front_cover:"",avatar:"",followingsCount:"",Followers:"",isFollowed:!1},reply:{},newTweet:{},isEditModalOpen:!1,isLoading:!0}},computed:{...Object(w["d"])(["currentUser","isReplyModalOpen"]),pageUserId(){return Number(this.$route.params.id)}},created(){const{id:t}=this.$route.params;this.fetchUser(t)},beforeRouteUpdate(t,a,e){if(a.params.id!==t.params.id){this.isLoading=!0;const a=t.params.id;this.fetchUser(a)}e()},methods:{...Object(w["c"])(["openReplyModal","closeReplyModal","createReply"]),async fetchUser(t){try{const{data:a}=await c["a"].getUser({id:t}),{id:e,name:r,tweetsCount:s,account:i,introduction:o,avatar:n,followingsCount:l,Followers:d,isFollowed:u}=a,C=a.front_cover;this.user={id:e,name:r,tweetsCount:s,account:i,introduction:o,frontCover:C,avatar:n,followingsCount:l,Followers:d,isFollowed:u},this.isLoading=!1}catch(a){d["a"].fire({icon:"error",title:"無法取得個人資料，請稍後再試"}),this.$router.push("/")}},async addFollow(t){try{const{data:a}=await c["a"].addFollow({id:t});if("error"===a.status)throw new Error(a.message);d["a"].fire({icon:"success",title:"追隨成功"}),this.user.isFollowed=!0}catch(a){d["a"].fire({icon:"error",title:"追隨失敗，請稍候再試"})}},async removeFollow(t){try{const{data:a}=await c["a"].removeFollow({id:t});if("error"===a.status)throw new Error(a.message);d["a"].fire({icon:"success",title:"移除追隨成功"}),this.user.isFollowed=!1}catch(a){d["a"].fire({icon:"error",title:"移除追隨失敗，請稍候再試"})}},afterCreateTweet(t){this.$route.params.id===this.currentUser.id&&(this.newTweet={...t})},afterCreateReply(t){this.reply={...t},this.createReply(t),this.closeReplyModal()},openEditModal(){this.pageUserId===this.currentUser.id&&(this.isEditModalOpen=!0)},closeEditModal(){this.isEditModalOpen=!1},afterSubmit(){const{id:t}=this.$route.params;this.fetchUser(t)}}},b=g,_=(e("a3b9"),Object(m["a"])(b,r,s,!1,null,"358f2008",null));a["default"]=_.exports},"2c25":function(t,a,e){},"314e":function(t,a,e){t.exports=e.p+"img/front-cover.fcac2f20.png"},6134:function(t,a,e){"use strict";e("2c25")},a3b9:function(t,a,e){"use strict";e("b248")},b248:function(t,a,e){}}]);
//# sourceMappingURL=chunk-c88f54be.33577f0b.js.map